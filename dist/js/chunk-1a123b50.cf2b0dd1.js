(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a123b50"],{"31f5":function(t,e,s){},"7be1":function(t,e,s){"use strict";s("31f5")},e006:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-info",staticStyle:{clear:"both"}},[t._m(0),e("el-form",{ref:"form",staticClass:"form-box",attrs:{"label-width":"124px",model:t.form,rules:t.rules}},[e("el-form-item",{staticClass:"custom-size",attrs:{prop:"status",label:"计划状态"}},[e("el-switch",{attrs:{"active-text":t.form.status,"active-value":"已开启","active-color":"rgb(22,140,0)","inactive-value":"已关闭","inactive-color":"rgb(200,0,0)"},on:{change:function(e){return t.changeScheduleSwitch()}},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"name",label:"计划名称"}},[e("el-input",{attrs:{placeholder:"请输入计划名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"stage",label:"测试阶段"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.stage,callback:function(e){t.$set(t.form,"stage",e)},expression:"form.stage"}},t._l(t.stageOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"gitRepository",label:"git地址"}},[e("el-input",{attrs:{placeholder:"请输入git地址"},model:{value:t.form.gitRepository,callback:function(e){t.$set(t.form,"gitRepository",e)},expression:"form.gitRepository"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"gitBranch",label:"git分支"}},[e("el-input",{attrs:{placeholder:"请输入git分支"},model:{value:t.form.gitBranch,callback:function(e){t.$set(t.form,"gitBranch",e)},expression:"form.gitBranch"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"jenkinsNode",label:"运行节点"}},[e("el-input",{attrs:{placeholder:"请输入jenkins节点"},model:{value:t.form.jenkinsNode,callback:function(e){t.$set(t.form,"jenkinsNode",e)},expression:"form.jenkinsNode"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"runCmd",label:"执行命令"}},[e("el-input",{attrs:{placeholder:"请输入执行命令"},model:{value:t.form.runCmd,callback:function(e){t.$set(t.form,"runCmd",e)},expression:"form.runCmd"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"crontabSwitch",label:"定时任务开关"}},[e("el-switch",{attrs:{"active-text":t.form.crontabSwitch,"active-value":"已开启","active-color":"rgb(22,140,0)","inactive-value":"已关闭","inactive-color":"rgb(200,0,0)"},on:{change:function(e){return t.changeScheduleSwitch()}},model:{value:t.form.crontabSwitch,callback:function(e){t.$set(t.form,"crontabSwitch",e)},expression:"form.crontabSwitch"}})],1),"已开启"===t.form.crontabSwitch?e("el-form-item",{staticClass:"custom-size",attrs:{prop:"crontabExpression",label:"计划时间"}},[e("el-input",{attrs:{placeholder:"请输入crontab表达式"},model:{value:t.form.crontabExpression,callback:function(e){t.$set(t.form,"crontabExpression",e)},expression:"form.crontabExpression"}},[e("el-popover",{attrs:{slot:"suffix",placement:"right",width:"450",trigger:"hover"},slot:"suffix"},[e("div",[e("pre",[e("b",[t._v("crontab表达式，共5位，最小粒度为分钟")]),t._v("\n*    *    *    *    *\n-    -    -    -    -\n|    |    |    |    |\n|    |    |    |    +----- 星期中星期几 (0 - 6) (星期天 为0)\n|    |    |    +---------- 月份 (1 - 12)\n|    |    +--------------- 一个月中的第几天 (1 - 31)\n|    +-------------------- 小时 (0 - 23)\n+------------------------- 分钟 (0 - 59)\n【每分钟】\n* * * * *\n【每小时的第一分】\n1 * * * *\n【每天7:50】\n50 7 * * *\n【每两个小时】\n0 */2 * * *\n【每月1号和15号】\n0 0 1,15 * *\n【每周一至周五3点钟】\n00 03 * * 1-5\n【每月的1、11、21、31日的6:30】\n30 6 */10 * *\n【每月每天的午夜0点20分, 2点20分, 4点20分】\n20 0-23/2 * * *\n【在12月内, 每天的早上6点到12点，每隔3个小时0分钟】\n0 6-12/3 * 12 *\n             ")])]),e("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1)],1):t._e(),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"emailSwitch",label:"通知开关"}},[e("el-switch",{attrs:{"active-text":t.form.emailSwitch,"active-value":"已开启","active-color":"rgb(22,140,0)","inactive-value":"已关闭","inactive-color":"rgb(200,0,0)"},on:{change:function(e){return t.changeScheduleSwitch()}},model:{value:t.form.emailSwitch,callback:function(e){t.$set(t.form,"emailSwitch",e)},expression:"form.emailSwitch"}})],1),e("el-form-item",{staticClass:"custom-size",attrs:{prop:"emailSendto",label:"通知人列表"}},[e("el-input",{attrs:{placeholder:"请输入通知人列表"},model:{value:t.form.emailSendto,callback:function(e){t.$set(t.form,"emailSendto",e)},expression:"form.emailSendto"}})],1),e("el-form-item",{staticClass:"custom-size"}),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.save}},[t._v("保存")]),e("el-button",{on:{click:t.back}},[t._v("取消")])],1)],1)],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-header"},[e("div",{staticClass:"info-name"},[t._v(" 基本信息 ")])])}],o=s("37b6"),a={data(){return{form:{name:"",releasePlanId:"",productId:"",stage:"",devUsers:"",testUsers:"",gitRepository:"",gitBranch:"",jenkinsNode:"",runCmd:"",status:"",crontabSwitch:"",crontabExpression:"",emailSwitch:"",emailSendto:"",versionNo:""},stageOptions:[{value:"冒烟测试",label:"冒烟测试"},{value:"SIT测试",label:"SIT测试"},{value:"回归测试",label:"回归测试"},{value:"灰度测试",label:"灰度测试"},{value:"其他测试",label:"其他测试"}],rules:{name:[{required:!0,message:"请输入计划名称",trigger:"blur"}],stage:[{required:!0,message:"请选择测试阶段",trigger:"blur"}],gitRepository:[{required:!0,message:"请输入git地址",trigger:"blur"},{validator:o["d"],trigger:"blur"}],gitBranch:[{required:!0,message:"请输入git分支",trigger:"blur"}],jenkinsNode:[{required:!0,message:"请输入运行节点",trigger:"blur"}],runCmd:[{required:!1,message:"请输入执行命令",trigger:"blur"}]},saving:!1,testPlanId:"",curVersionNo:"",versionList:[],curProductId:"",productVersionList:[],popoverActive:!1,taskText:"关闭"}},created(){let t=localStorage.getItem("testPlanInfo");t&&(t=JSON.parse(t),this.testPlanId=t.id,this.form.name=t.name,this.form.releasePlanId=t.releasePlanId,this.form.stage=t.stage,this.form.devUsers=t.devUsers,this.form.testUsers=t.testUsers,this.form.gitRepository=t.gitRepository,this.form.gitBranch=t.gitBranch,this.form.jenkinsNode=t.jenkinsNode,this.form.runCmd=t.runCmd,this.form.status=t.status,this.form.crontabSwitch=t.crontabSwitch,this.form.crontabExpression=t.crontabExpression,this.form.emailSwitch=t.emailSwitch,this.form.emailSendto=t.emailSendto,this.form.versionNo=t.versionNo),this.getProductVersion()},methods:{getProductVersion(){let t=JSON.parse(localStorage.getItem("productVersionList"));t&&(this.productVersionList=t)},getCurProductId(){let t=JSON.parse(localStorage.getItem("curProductVersion"));t&&(this.curProductId=t.curProductId)},getVersionList(){this.getCurProductId(),this.productVersionList.forEach(t=>{t.productId===this.curProductId&&(this.versionList=t.versionList)})},setTaskText(){"1"===this.form.status&&(this.taskText="开启"),"0"===this.form.status&&(this.taskText="关闭")},changeScheduleSwitch(){},save(){this.$refs.form.validate(t=>{if(!t)return!1;{this.saving=!0,this.form.name=this.form.name.trim(),this.form.stage=this.form.stage.trim();let t=JSON.parse(localStorage.getItem("curProductVersion")),e=t.curProductId,s=t.curVersionNo,r={name:this.form.name,stage:this.form.stage,status:this.form.status,gitRepository:this.form.gitRepository,gitBranch:this.form.gitBranch,jenkinsNode:this.form.jenkinsNode,runCmd:this.form.runCmd,devUsers:this.form.devUsers,testUsers:this.form.testUsers,crontabSwitch:this.form.crontabSwitch,crontabExpression:this.form.crontabExpression,emailSwitch:this.form.emailSwitch,emailSendto:this.form.emailSendto,versionNo:s,productId:e,releasePlanId:this.form.releasePlanId};if("已开启"===r.status&&!r.runCmd)return void this.$notifyMessage("执行命令不能为空！",{type:"error"});if(this.testPlanId){let t="/hirunner/testPlans/"+this.testPlanId;this.$http.put(t,r).then(()=>{this.back(),this.$notifyMessage("修改计划成功",{type:"success"})})}else{let t="/hirunner/testPlans";this.$http.post(t,r).then(()=>{this.back(),this.$notifyMessage("新增计划成功",{type:"success"})})}this.saving=!1}})},back(){this.$router.go(-1)}}},n=a,l=(s("7be1"),s("2877")),c=Object(l["a"])(n,r,i,!1,null,"6d76437d",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-1a123b50.cf2b0dd1.js.map