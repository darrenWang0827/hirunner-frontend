(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-261da536"],{"503d":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t._self._c;return e("div",["productManagement"===t.$route.name?e("WrapComponent",{attrs:{tableTitle:"全部产品"}},[e("el-button",{staticClass:"pri-add-btn",attrs:{slot:"operate",type:"primary",icon:"el-icon-circle-plus"},on:{click:function(e){return t.onOperate("new")}},slot:"operate"},[t._v(" 新增产品 ")]),e("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{slot:"form",model:t.searchForm,inline:!0},slot:"form"},[e("el-form-item",{attrs:{label:"产品名称",prop:"keyword"}},[e("el-input",{attrs:{placeholder:"产品名称"},model:{value:t.searchForm.keyword,callback:function(e){t.$set(t.searchForm,"keyword",e)},expression:"searchForm.keyword"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getProductList}},[t._v("搜索")]),e("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.resetForm}},[t._v("重置")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{slot:"table",data:t.tableData,"header-cell-style":{background:"rgba(144, 147, 153, 0.06)",color:"rgba(0, 0, 0, 0.65)",fontSize:"14px"}},slot:"table"},[e("el-table-column",{attrs:{prop:"productId",label:"dpms产品ID"}}),e("el-table-column",{attrs:{prop:"name",label:"产品名称","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"releasePlanNameKw",label:"发布计划关键词"}}),e("el-table-column",{attrs:{prop:"testUsers",label:"测试负责人"}}),e("el-table-column",{attrs:{prop:"devUsers",label:"开发负责人"}}),e("el-table-column",{attrs:{label:"操作",width:"600px"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("div",[e("el-button",{attrs:{type:"info",size:"mini",plain:""},on:{click:function(e){return t.onOperate("edit",r.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini",plain:""},on:{click:function(e){return t.onDel("删除",r.row)}}},[t._v("删除")]),e("el-button",{attrs:{type:"info",size:"mini",plain:""},on:{click:function(e){return t.gotoTestPlanConfig(r.row)}}},[t._v("版本默认计划")])],1)]}}],null,!1,909559040)})],1),e("div",{staticClass:"content-footer clear",attrs:{slot:"footer"},slot:"footer"},[e("div",{staticClass:"block page-list self-right"},[e("vue-pagination",t._b({on:{sizeChange:t.changeSize,currentPageChange:t.changeCurrentPage}},"vue-pagination",t.pageParams,!1))],1)])],1):t._e(),e("AddProductDialog",{attrs:{dialogFormVisible:t.dialogFormVisible,dialogTitle:t.dialogTitle,id:t.curId},on:{"update:dialogFormVisible":function(e){t.dialogFormVisible=e},"update:dialog-form-visible":function(e){t.dialogFormVisible=e},success:t.resetForm}}),e("router-view")],1)},a=[],o=(r("14d9"),r("e523")),i=r("925a"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrap"},[e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.visible,width:"600px","close-on-click-modal":!1},on:{close:t.onResetForm}},[e("el-form",{ref:"productFormRef",staticClass:"form-common",attrs:{model:t.productForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"产品ID",prop:"productId"}},[e("el-input",{staticClass:"input-380",attrs:{placeholder:"请输入DPMS的产品ID"},model:{value:t.productForm.productId,callback:function(e){t.$set(t.productForm,"productId",e)},expression:"productForm.productId"}})],1),e("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[e("el-input",{staticClass:"input-380",attrs:{placeholder:"请输入产品名称"},model:{value:t.productForm.name,callback:function(e){t.$set(t.productForm,"name",e)},expression:"productForm.name"}})],1),e("el-form-item",{attrs:{label:"发布计划名称关键词",prop:"releasePlanNameKw"}},[e("el-input",{staticClass:"input-380",attrs:{placeholder:"如DPMS有其他产品的，请输入以做为区分"},model:{value:t.productForm.releasePlanNameKw,callback:function(e){t.$set(t.productForm,"releasePlanNameKw",e)},expression:"productForm.releasePlanNameKw"}})],1),e("el-form-item",{attrs:{label:"测试负责人",prop:"testUsers"}},[e("el-input",{staticClass:"input-380",attrs:{placeholder:"请输入测试负责人"},model:{value:t.productForm.testUsers,callback:function(e){t.$set(t.productForm,"testUsers",e)},expression:"productForm.testUsers"}})],1),e("el-form-item",{attrs:{label:"开发负责人",prop:"devUsers"}},[e("el-input",{staticClass:"input-380",attrs:{placeholder:"请输入开发负责人"},model:{value:t.productForm.devUsers,callback:function(e){t.$set(t.productForm,"devUsers",e)},expression:"productForm.devUsers"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.onResetForm}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",loading:t.isLoading},on:{click:t.onSubmit}},[t._v("确 定")])],1)],1)],1)},n=[],c=r("37b6"),d={name:"AddProduct",props:{dialogTitle:{type:String,default:"新增"},dialogFormVisible:{type:Boolean,default:!1},id:{default:""}},computed:{visible(){return this.dialogFormVisible}},watch:{dialogFormVisible(t){t&&this.id&&this.getDetail()}},data(){return{isLoading:!1,productForm:{productId:"",name:"",releasePlanNameKw:"",devUsers:"",testUsers:""},rules:{productId:[{required:!0,message:"产品id不能为空",trigger:"blur"},{validator:c["c"],trigger:"blur"}],name:[{required:!0,message:"产品名称不能为空",trigger:"blur"}],releasePlanNameKw:[],devUsers:[{required:!0,message:"开发负责人不能为空",trigger:"blur"},{validator:c["h"],trigger:"blur"}],testUsers:[{required:!0,message:"测试负责人不能为空",trigger:"blur"},{validator:c["h"],trigger:"blur"}]}}},methods:{getDetail(){this.$http.get("/hirunner/products/"+this.id).then(({data:t})=>{this.productForm.productId=t.productId,this.productForm.name=t.name,this.productForm.releasePlanNameKw=t.releasePlanNameKw,this.productForm.devUsers=t.devUsers,this.productForm.testUsers=t.testUsers})},onResetForm(){this.$refs.productFormRef.resetFields(),this.isLoading=!1,this.productForm.productId="",this.productForm.name="",this.productForm.releasePlanNameKw="",this.productForm.devUsers="",this.productForm.testUsers="",this.$emit("update:dialogFormVisible",!1)},onSubmit(){this.$refs.productFormRef.validate(t=>{t&&(this.productForm.name=this.productForm.name.trim(),this.productForm.releasePlanNameKw=this.productForm.releasePlanNameKw.trim(),this.productForm.devUsers=this.productForm.devUsers.trim(),this.productForm.testUsers=this.productForm.testUsers.trim(),this.isLoading=!0,this.onRequest())})},onRequest(){const{productId:t,name:e,releasePlanNameKw:r,devUsers:s,testUsers:a}=this.productForm;let o={productId:t,name:e,releasePlanNameKw:r,devUsers:s,testUsers:a},i="post",l="/hirunner/products";this.id&&(i="put",l="/hirunner/products/"+this.id),this.$http[i](l,o).then(()=>{this.$notifyMessage("保存成功",{type:"success"}),this.onResetForm(),this.$emit("success")}).finally(()=>{this.isLoading=!1})},logout(){let t=localStorage.getItem("loginInfo"),e=localStorage.getItem("loginTime");localStorage.clear(),e&&localStorage.setItem("loginTime",(new Date).getTime().toLocaleString()),t&&(t=JSON.parse(t),t.userPWD="",localStorage.setItem("loginInfo",JSON.stringify(t)))}}},u=d,m=(r("b3d9"),r("2877")),p=Object(m["a"])(u,l,n,!1,null,"2e6b84b5",null),g=p.exports,h={name:"ProductManagement",components:{WrapComponent:o["a"],AddProductDialog:g},data(){return{loading:!1,dialogFormVisible:!1,dialogTitle:"新增产品",curId:"",searchForm:{keyword:"",roleNames:"",status:""},tableData:[],pageParams:{currentPage:1,pageSize:10,totalNum:0}}},created(){this.getProductList()},methods:{onOperate(t,e=""){const r={new:"新增产品",edit:"编辑产品"};this.dialogTitle=r[t],this.dialogFormVisible=!0,this.curId=e},onDel(t,e){Object(i["a"])(`是否${t}此产品？`,()=>{this.operateRow(t,e)},{confirmButtonText:t})},operateRow(t,{id:e}){let r,s,a={};"删除"===t&&(r="/hirunner/products/"+e,s="delete"),this.$http[s](r,a).then(()=>{this.$notifyMessage(t+"成功",{type:"success"}),this.$refs.searchForm.resetFields(),this.getProductList()})},gotoTestPlanConfig(t){console.log(t.id);let e=JSON.stringify(t);localStorage.setItem("productInfo",e),this.$router.push({name:"testPlanConfigList"})},gotoCiTestPlanConfig(t){console.log(t.id);let e=JSON.stringify(t);localStorage.setItem("productInfo",e),this.$router.push({name:"ciTestPlanConfigList"})},getProductList(){this.loading=!0;let t={...this.searchForm,page:this.pageParams.currentPage,perPage:this.pageParams.pageSize,sortField:"id"};this.$http.get("/hirunner/products",{params:Object(i["b"])(t)}).then(({data:{items:t,totalNum:e}})=>{this.pageParams.totalNum=e,t?this.tableData=t.map(t=>({id:t.id,productId:t.productId,name:t.name,gitRepository:t.gitRepository,gitBranch:t.gitBranch,devUsers:t.devUsers,testUsers:t.testUsers,releasePlanNameKw:t.releasePlanNameKw})):(e>0&&this.pageParams.currentPage>1&&(this.pageParams.currentPage--,this.getProductList()),this.tableData=[])}).finally(()=>{this.loading=!1})},resetForm(){this.$refs.searchForm.resetFields(),this.getProductList()},changeSize(t){this.pageParams.pageSize=t,this.pageParams.currentPage=1,this.getProductList()},changeCurrentPage(t){this.pageParams.currentPage=t,this.getProductList()}},watch:{$route:{handler(t){"productManagement"===t.name&&this.getProductList()},immediate:!0}}},f=h,b=Object(m["a"])(f,s,a,!1,null,null,null);e["default"]=b.exports},"9b29":function(t,e,r){},b3d9:function(t,e,r){"use strict";r("9b29")},e523:function(t,e,r){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrap"},[e("div",{staticStyle:{float:"left","margin-right":"10px"}},[t._t("productVersion")],2),t.showOperateCont?e("div",{staticClass:"control-list",staticStyle:{float:"left"}},[t._t("operate")],2):t._e(),e("div",{staticClass:"content-info",staticStyle:{clear:"both"}},[2===t.searchLayout?[e("div",{staticClass:"content-header"},[e("div",{staticClass:"info-name"},[t._v(t._s(t.tableTitle))])]),t._t("form")]:e("div",{staticClass:"content-header clear"},[e("div",{staticClass:"self-left info-name"},[t._v(t._s(t.tableTitle))]),e("div",{staticClass:"self-right"},[t._t("form")],2)]),e("div",{staticClass:"content-table"},[t._t("table")],2),t._t("footer")],2)])},a=[],o={name:"WrapComponent",props:{tableTitle:{type:String,default:"全部内容"},searchLayout:{type:Number,default:2},showOperateCont:{type:Boolean,default:!0}}},i=o,l=r("2877"),n=Object(l["a"])(i,s,a,!1,null,null,null);e["a"]=n.exports}}]);
//# sourceMappingURL=chunk-261da536.c2fcce66.js.map