(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36d74850"],{"00ee":function(t,e,r){"use strict";var o=r("b622"),a=o("toStringTag"),n={};n[a]="z",t.exports="[object z]"===String(n)},"271a":function(t,e,r){"use strict";var o=r("cb2d"),a=r("e330"),n=r("577e"),s=r("d6d6"),i=URLSearchParams,c=i.prototype,l=a(c.getAll),u=a(c.has),d=new i("a=1");!d.has("a",2)&&d.has("a",void 0)||o(c,"has",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return u(this,t);var o=l(this,t);s(e,1);var a=n(r),i=0;while(i<o.length)if(o[i++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},"3f81":function(t,e,r){"use strict";r("67df")},5494:function(t,e,r){"use strict";var o=r("83ab"),a=r("e330"),n=r("edd0"),s=URLSearchParams.prototype,i=a(s.forEach);o&&!("size"in s)&&n(s,"size",{get:function(){var t=0;return i(this,(function(){t++})),t},configurable:!0,enumerable:!0})},"577e":function(t,e,r){"use strict";var o=r("f5df"),a=String;t.exports=function(t){if("Symbol"===o(t))throw new TypeError("Cannot convert a Symbol value to a string");return a(t)}},"67df":function(t,e,r){},"88a7":function(t,e,r){"use strict";var o=r("cb2d"),a=r("e330"),n=r("577e"),s=r("d6d6"),i=URLSearchParams,c=i.prototype,l=a(c.append),u=a(c["delete"]),d=a(c.forEach),h=a([].push),p=new i("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&o(c,"delete",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return u(this,t);var o=[];d(this,(function(t,e){h(o,{key:e,value:t})})),s(e,1);var a,i=n(t),c=n(r),p=0,g=0,m=!1,f=o.length;while(p<f)a=o[p++],m||a.key===i?(m=!0,u(this,a.key)):g++;while(g<f)a=o[g++],a.key===i&&a.value===c||l(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},acef:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t._self._c;return e("div",["testPlanManagement"===t.$route.name?e("product-version",{staticStyle:{float:"left","margin-right":"10px"},on:{changeProduct:t.changeProduct,changeVersion:t.changeVersion,"product-version-rendered":t.resetSearchForm}}):t._e(),"addTestPlan"===t.$route.name?e("product-version",{staticStyle:{float:"left","margin-right":"10px"},attrs:{showVersion:!0},on:{changeProduct:t.changeProduct,changeVersion:t.changeVersion,"product-version-rendered":t.resetSearchForm}}):t._e(),"editTestPlan"===t.$route.name?e("product-version",{staticStyle:{float:"left","margin-right":"10px"},attrs:{showVersion:!0,"product-disabled":!0},on:{changeProduct:t.changeProduct,changeVersion:t.changeVersion,"product-version-rendered":t.resetSearchForm}}):t._e(),"testPlanManagement"===t.$route.name?e("div",{staticClass:"plan-manage-index"},[e("div",{staticClass:"control-list",staticStyle:{float:"left"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addTestPlan}},[t._v(" 新增计划 ")])],1),e("div",{staticClass:"content-info",staticStyle:{clear:"both"},attrs:{loading:t.tableLoading}},[t._m(0),e("div",{staticClass:"content-table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"rgba(144, 147, 153, 0.06)",color:"rgba(0, 0, 0, 0.65)",fontSize:"14px"},data:t.tableData,"row-class-name":t.numStyle}},[e("el-table-column",{attrs:{prop:"id",label:"ID",width:"80px",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"计划名称",width:"500px",prop:"name","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"stage",label:"测试阶段",width:"100px",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"releasePlanId",label:"发布计划ID",width:"100px",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"status",label:"计划状态",width:"100px",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"testUsers",label:"测试负责人",width:"250px",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作",width:"550px"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("div",[e("el-tooltip",{attrs:{content:"编辑",placement:"top"}},[e("el-button",{attrs:{type:"info",icon:"el-icon-edit-outline",size:"mini",plain:""},on:{click:function(e){return t.gotoTestPlanEditor(r.row)}}})],1),e("el-tooltip",{attrs:{content:"复制",placement:"top"}},[e("el-button",{attrs:{type:"info",icon:"el-icon-copy-document",size:"mini",plain:""},on:{click:function(e){return t.gotoTestPlanCopy(r.row)}}})],1),e("el-tooltip",{attrs:{content:"立即执行",placement:"top"}},[e("el-button",{attrs:{type:"info",icon:"el-icon-video-play",size:"mini",plain:""},on:{click:function(e){return t.runTestPlanNow(r.row)}}})],1),e("el-tooltip",{attrs:{content:"删除",placement:"top"}},[e("el-button",{attrs:{type:"danger",icon:"el-icon-document-delete",size:"mini",plain:""},on:{click:function(e){return t.deleteTestPlan(r.row)}}})],1),e("el-tooltip",{attrs:{content:"查看执行历史记录",placement:"top"}},[e("el-button",{attrs:{type:"info",icon:"el-icon-tickets",size:"mini",plain:""},on:{click:function(e){return t.gotoTestPlanResultList(r.row)}}})],1)],1)]}}],null,!1,3694718767)})],1)],1),e("div",{staticClass:"content-footer clear"},[e("div",{staticClass:"block page-list self-right"},[e("vue-pagination",{attrs:{currentPage:t.searchForm.page,pageSize:t.searchForm.perPage,totalNum:t.total},on:{sizeChange:t.pageSizeChange,currentPageChange:t.pageChange}})],1)])])]):t._e(),e("router-view")],1)},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-header"},[e("div",{staticClass:"info-name"},[t._v(" 全部计划 ")])])}],n=(r("88a7"),r("271a"),r("5494"),r("14d9"),function(){var t=this,e=t._self._c;return e("el-form",{attrs:{inline:!0}},[t.showProduct?e("el-form-item",{attrs:{label:"产品"}},[e("el-select",{on:{change:t.changeProduct},nativeOn:{click:function(e){return t.getProductList.apply(null,arguments)}},model:{value:t.curProductName,callback:function(e){t.curProductName=e},expression:"curProductName"}},t._l(t.productList,(function(t,r){return e("el-option",{key:r,attrs:{label:t,value:t}})})),1)],1):t._e(),t.showVersion?e("el-form-item",{attrs:{label:"版本"}},[e("el-select",{on:{change:t.changeVersion},nativeOn:{click:function(e){return t.getVersionList.apply(null,arguments)}},model:{value:t.curVersionNo,callback:function(e){t.curVersionNo=e},expression:"curVersionNo"}},t._l(t.versionList,(function(t,r){return e("el-option",{key:r,attrs:{label:t,value:t}})})),1)],1):t._e()],1)}),s=[],i={name:"ProductVersion",props:{showVersion:{type:Boolean,default:!0},showProduct:{type:Boolean,default:!0}},data(){return{productVersionList:[],productList:[],versionList:[],curProductId:"",curReleasePlanNameKw:"",curProductName:"",curVersionNo:""}},created(){},mounted(){this.refreshProductVersionList(),this.getCurProductVersion()},methods:{getProductVersion(){let t=JSON.parse(localStorage.getItem("productVersionList"));t&&(this.productVersionList=t)},getCurProductVersion(){let t=JSON.parse(localStorage.getItem("curProductVersion"));t&&(this.curProductId=t.curProductId,this.curReleasePlanNameKw=t.curReleasePlanNameKw,this.curProductName=t.curProductName,this.curVersionNo=t.curVersionNo)},getProductList(){let t=[];this.productVersionList.forEach(e=>{t.push(e.productName)}),this.productList=t},getVersionList(){this.productVersionList.forEach(t=>{t.productId===this.curProductId&&t.releasePlanNameKw===this.curReleasePlanNameKw&&(this.versionList=t.versionList)})},changeProduct(){let t={};this.productVersionList.forEach(t=>{t.productName===this.curProductName&&(this.curProductId=t.productId,this.curReleasePlanNameKw=t.releasePlanNameKw)}),t["curProductId"]=this.curProductId,t["curReleasePlanNameKw"]=this.curReleasePlanNameKw,t["curProductName"]=this.curProductName,console.log(t),this.getVersionList(),this.curVersionNo=this.versionList[0],t["curVersionNo"]=this.curVersionNo,localStorage.setItem("curProductVersion",JSON.stringify(t)),this.$emit("changeProduct")},changeVersion(){let t={};t["curProductId"]=this.curProductId,t["curReleasePlanNameKw"]=this.curReleasePlanNameKw,t["curProductName"]=this.curProductName,t["curVersionNo"]=this.curVersionNo,localStorage.setItem("curProductVersion",JSON.stringify(t)),this.$emit("changeVersion")},refreshProductVersionList(){this.$http.get("/hirunner/products/version").then(({data:{productVersionList:t,curProductVersion:e}})=>{t&&e&&(this.productVersionList=t,localStorage.setItem("productVersionList",JSON.stringify(t)),localStorage.getItem("curProductVersion")||(this.curProductId=e.curProductId,this.curReleasePlanNameKw=e.curReleasePlanNameKw,this.curProductName=e.curProductName,this.curVersionNo=e.curVersionNo,localStorage.setItem("curProductVersion",JSON.stringify(e))),this.$emit("product-version-rendered"))}).finally(()=>{})}}},c=i,l=r("2877"),u=Object(l["a"])(c,n,s,!1,null,"1eb1f7a1",null),d=u.exports,h=r("925a"),p={name:"TestPlanManagement",data(){return{searchForm:{page:1,perPage:10,name:""},total:0,tableData:[],tableLoading:!1}},components:{ProductVersion:d},mounted(){},methods:{async getTableData(){let t=Object.keys(this.searchForm),e=new URLSearchParams;t.forEach(t=>{let r=this.searchForm[t];r&&e.append(""+t,""+this.searchForm[t])});let r=JSON.parse(localStorage.getItem("curProductVersion")),o=r.curProductId;o&&e.append("productId",""+o);let a=r.curVersionNo;a&&(console.log(a),console.log(""+a),e.append("versionNo",""+a)),e.append("releasePlanNameKw",""+r.curReleasePlanNameKw),console.log(e);let n="/hirunner/testPlans?"+e.toString();console.log(n),this.tableLoading=!0,await this.$http.get(n).then(async({data:t})=>{this.tableData=t.items||[],this.total=t.totalNum,!t.items&&t.totalNum>0&&this.searchForm.page>1&&(this.searchForm.page--,await this.getTableData())}),this.tableLoading=!1},addTestPlan(){Object(h["d"])()?(localStorage.removeItem("testPlanInfo"),this.$router.push({name:"addTestPlan"})):this.$notifyMessage("请先创建产品",{type:"error"})},search(){this.searchForm.page=1,this.getTableData()},numStyle({row:t}){return"已开启"===t.status?"opened-row":"closed-row"},runTestPlanNow(t){t.runCmd?this.$http.post(`/hirunner/testPlans/${t.id}/run`,{}).then(({data:{msg:t}})=>{this.$notifyMessage(t,{type:"success"}),this.getTableData()}):this.$notifyMessage("执行命令不能为空！",{type:"error"})},deleteTestPlan(t){this.$confirm("确认删除该计划吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",confirmButtonClass:"el-button--danger",type:"warning"}).then(async()=>{this.tableLoading=!0;let e="/hirunner/testPlans/"+t.id;await this.$http.delete(e).then(async()=>{this.$notifyMessage("删除成功",{type:"success"}),await this.getTableData()}),this.tableLoading=!1})},resetSearchForm(){this.searchForm={page:1,perPage:10,name:""},this.getTableData()},changeProduct(){this.resetSearchForm()},changeVersion(){this.resetSearchForm()},pageSizeChange(t){this.searchForm.perPage=t,this.getTableData()},pageChange(t){this.searchForm.page=t,this.getTableData()},gotoTestPlanEditor(t){let e=JSON.stringify(t);localStorage.setItem("testPlanInfo",e),this.$router.push({name:"editTestPlan"})},gotoTestPlanCopy(t){let e=JSON.parse(JSON.stringify(t));delete e.id,e.name=e.name+"_copy",localStorage.setItem("testPlanInfo",JSON.stringify(e)),this.$router.push({name:"addTestPlan"})},gotoTestPlanResultList(t){let e=JSON.stringify(t);localStorage.setItem("testPlanInfo",e),this.$router.push({name:"testPlanResultList"})}},watch:{$route:{handler(t){"testPlanManagement"===t.name&&this.getTableData()},immediate:!0}}},g=p,m=(r("3f81"),Object(l["a"])(g,o,a,!1,null,"2cd93d99",null));e["default"]=m.exports},d6d6:function(t,e,r){"use strict";var o=TypeError;t.exports=function(t,e){if(t<e)throw new o("Not enough arguments");return t}},edd0:function(t,e,r){"use strict";var o=r("13d2"),a=r("9bf2");t.exports=function(t,e,r){return r.get&&o(r.get,e,{getter:!0}),r.set&&o(r.set,e,{setter:!0}),a.f(t,e,r)}},f5df:function(t,e,r){"use strict";var o=r("00ee"),a=r("1626"),n=r("c6b6"),s=r("b622"),i=s("toStringTag"),c=Object,l="Arguments"===n(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(r){}};t.exports=o?n:function(t){var e,r,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(e=c(t),i))?r:l?n(e):"Object"===(o=n(e))&&a(e.callee)?"Arguments":o}}}]);
//# sourceMappingURL=chunk-36d74850.b4190f86.js.map